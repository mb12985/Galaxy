{"version":3,"file":"history-model.js","sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","UTILS","BASE_MVC","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","defaults","model_class","id","name","state","diskSize","deleted","urlRoot","galaxy_config","root","initialize","historyJSON","contentsJSON","options","this","logger","log","contents","HistoryContents","historyId","get","_setUpListeners","updateTimeoutId","on","model","xhr","msg","details","errorHandler","listenTo","trigger","apply","concat","jQuery","makeArray","arguments","newId","clearUpdateTimeout","nice_size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","Galaxy","currUser","isAnonymous","contentsCount","reduce","values","memo","num","searchAttributes","searchAliases","title","tag","checkForUpdates","onReadyCallback","running","length","setUpdateTimeout","isFunction","delay","UPDATE_DELAY","history","setTimeout","refresh","clearTimeout","detailIds","data","join","fetch","done","_delete","when","save","purge","purged","undelete","copy","current","undefined","Error","postData","history_id","post","then","response","newHistory","setAsCurrent","getJSON","toString","getHistoryData","getHistory","ajax","isEmpty","historyData","empty","getContents","detailIdsFn","hdcaDetailIds","dataset_details","dataset_collection_details","df","Deferred","historyFn","contentsFn","historyXHR","json","notify","status","fail","reject","contentsXHR","resolve","ControlledFetchMixin","_buildFetchData","traditional","Collection","_fetchOptions","fetchDefaults","_fetchDefaults","pick","filters","has","_buildFetchFilters","filterMap","q","qv","each","v","k","push","HistoryCollection","DEFAULT_ORDER","sortOrders","update_time","getter","h","Date","asc","update_time-asc","name-dsc","size","size-asc","models","includeDeleted","setOrder","order","currentHistoryId","setUpListeners","window","url","view","change:deleted","debug","remove","copied","original","newData","unshift","set-as-current","oldCurrentId","sort","collection","sortOrder","isUndefined","comparator","a","b","allFetched","fetchOptions","offset","limit","fetchData","numFetched","isArray","create","hdas","historyOptions","reset"],"mappings":"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"}